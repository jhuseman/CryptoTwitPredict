#! /usr/bin/env python

"""script used to convert files between formats in batches sequentially"""

import os
from ConvertData import ConvertData
from ConcatArrayData import concat_arr_data_files

TO_CONVERT = {
	"from": {
		"type":"jsonl",
		"files": [
			'data/InitialData_Sat_Mar_17_04_50_56_2018.txt',
			'data/InitialData_Sat_Mar_17_04_52_27_2018.txt',
			'data/InitialData_Sat_Mar_17_05_51_12_2018.txt',
			'data/InitialData_Sat_Mar_17_05_53_05_2018.txt',
			'data/InitialData_Sat_Mar_17_06_03_13_2018.txt',
			'data/InitialData_Sat_Mar_17_06_03_34_2018.txt',
			'data/InitialData_Sat_Mar_17_06_06_50_2018.txt',
			'data/InitialData_Sat_Mar_17_06_15_13_2018.txt',
			'data/InitialData_Sat_Mar_17_06_17_54_2018.txt',
			'data/InitialData_Sun_Mar_18_07_04_43_2018.txt',
			'data/InitialData_Sun_Mar_18_08_03_21_2018.txt',
			'data/InitialData_Sun_Mar_18_08_19_48_2018.txt',
			'data/InitialData_Sun_Mar_18_23_04_53_2018.txt',
			'data/InitialData_Mon_Mar_19_14_22_02_2018.txt',
			'data/test/InitialData_Mon_Mar_19_16_15_22_2018aa',
			'data/test/InitialData_Mon_Mar_19_16_15_22_2018ab',
			'data/test/InitialData_Mon_Mar_19_16_15_22_2018ac',
			'data/test/InitialData_Mon_Mar_19_16_15_22_2018ad',
			'data/test/InitialData_Mon_Mar_19_16_15_22_2018ae',
			'data/test/InitialData_Mon_Mar_19_16_15_22_2018af',
			'data/test/InitialData_Mon_Mar_19_16_15_22_2018ag',
			'data/test/InitialData_Mon_Mar_19_16_15_22_2018ah',
			'data/test/InitialData_Mon_Mar_19_16_15_22_2018ai',
			'data/test/InitialData_Mon_Mar_19_16_15_22_2018aj',
			'data/test/InitialData_Mon_Mar_19_16_15_22_2018ak',
			'data/test/InitialData_Mon_Mar_19_16_15_22_2018al',
			'data/test/InitialData_Mon_Mar_19_16_15_22_2018am',
			'data/test/InitialData_Mon_Mar_19_16_15_22_2018an',
			'data/test/InitialData_Mon_Mar_19_16_15_22_2018ao',
			'data/test/InitialData_Mon_Mar_19_16_15_22_2018ap',
			'data/test/InitialData_Mon_Mar_19_16_15_22_2018aq',
			'data/test/InitialData_Mon_Mar_19_16_15_22_2018ar',
			'data/test/InitialData_Mon_Mar_19_16_15_22_2018as',
			'data/test/InitialData_Mon_Mar_19_16_15_22_2018at',
			'data/test/InitialData_Mon_Mar_19_16_15_22_2018au',
			'data/test/InitialData_Mon_Mar_19_16_15_22_2018av',
			'data/test/InitialData_Mon_Mar_19_16_15_22_2018aw',
			'data/test/InitialData_Mon_Mar_19_16_15_22_2018ax',
			'data/test/InitialData_Mon_Mar_19_16_15_22_2018ay',
			'data/test/InitialData_Mon_Mar_19_16_15_22_2018az',
			'data/test/InitialData_Mon_Mar_19_16_15_22_2018ba',
			'data/test/InitialData_Mon_Mar_19_16_15_22_2018bb',
			'data/test/InitialData_Mon_Mar_19_16_15_22_2018bc',
			'data/test/InitialData_Mon_Mar_19_16_15_22_2018bd',
			'data/test/InitialData_Mon_Mar_19_16_15_22_2018be',
			'data/test/InitialData_Mon_Mar_19_16_15_22_2018bf',
			'data/test/InitialData_Mon_Mar_19_16_15_22_2018bg',
			'data/test/InitialData_Mon_Mar_19_16_15_22_2018bh',
			'data/test/InitialData_Mon_Mar_19_16_15_22_2018bi',
			'data/test/InitialData_Mon_Mar_19_16_15_22_2018bj',
			'data/test/InitialData_Mon_Mar_19_16_15_22_2018bk',
			'data/test/InitialData_Mon_Mar_19_16_15_22_2018bl',
			'data/test/InitialData_Mon_Mar_19_16_15_22_2018bm',
			'data/test/InitialData_Mon_Mar_19_16_15_22_2018bn',
			'data/test/InitialData_Mon_Mar_19_16_15_22_2018bo',
			'data/test/InitialData_Mon_Mar_19_16_15_22_2018bp',
			'data/test/InitialData_Mon_Mar_19_16_15_22_2018bq',
			'data/test/InitialData_Mon_Mar_19_16_15_22_2018br',
			'data/test/InitialData_Mon_Mar_19_16_15_22_2018bs',
			'data/test/InitialData_Mon_Mar_19_16_15_22_2018bt',
			'data/test/InitialData_Mon_Mar_19_16_15_22_2018bu',
			'data/test/InitialData_Mon_Mar_19_16_15_22_2018bv',
			'data/test/InitialData_Mon_Mar_19_16_15_22_2018bw',
			'data/test/InitialData_Mon_Mar_19_16_15_22_2018bx',
			'data/test/InitialData_Mon_Mar_19_16_15_22_2018by',
			'data/test/InitialData_Mon_Mar_19_16_15_22_2018bz',
			'data/test/InitialData_Mon_Mar_19_16_15_22_2018ca',
			'data/test/InitialData_Mon_Mar_19_16_15_22_2018cb',
			'data/test/InitialData_Mon_Mar_19_16_15_22_2018cc',
			'data/test/InitialData_Mon_Mar_19_16_15_22_2018cd',
			'data/test/InitialData_Mon_Mar_19_16_15_22_2018ce',
			'data/test/InitialData_Mon_Mar_19_16_15_22_2018cf',
			'data/test/InitialData_Mon_Mar_19_16_15_22_2018cg',
			'data/test/InitialData_Mon_Mar_19_16_15_22_2018ch',
			'data/test/InitialData_Mon_Mar_19_16_15_22_2018ci',
			'data/test/InitialData_Mon_Mar_19_16_15_22_2018cj',
			'data/test/InitialData_Mon_Mar_19_16_15_22_2018ck',
			'data/test/InitialData_Mon_Mar_19_16_15_22_2018cl',
			'data/test/InitialData_Mon_Mar_19_16_15_22_2018cm',
			'data/test/InitialData_Mon_Mar_19_16_15_22_2018cn',
			'data/test/InitialData_Mon_Mar_19_16_15_22_2018co',
			'data/test/InitialData_Mon_Mar_19_16_15_22_2018cp',
			'data/test/InitialData_Mon_Mar_19_16_15_22_2018cq',
			'data/test/InitialData_Mon_Mar_19_16_15_22_2018cr',
			'data/test/InitialData_Mon_Mar_19_16_15_22_2018cs',
			'data/test/InitialData_Mon_Mar_19_16_15_22_2018ct',
			'data/test/InitialData_Mon_Mar_19_16_15_22_2018cu',
			'data/test/InitialData_Mon_Mar_19_16_15_22_2018cv',
			'data/test/InitialData_Mon_Mar_19_16_15_22_2018cw',
			'data/test/InitialData_Mon_Mar_19_16_15_22_2018cx',
			'data/test/InitialData_Mon_Mar_19_16_15_22_2018cy',
			'data/test/InitialData_Mon_Mar_19_16_15_22_2018cz',
			'data/test/InitialData_Mon_Mar_19_16_15_22_2018da',
			'data/test/InitialData_Mon_Mar_19_16_15_22_2018db',
			'data/test/InitialData_Mon_Mar_19_16_15_22_2018dc',
			'data/test/InitialData_Mon_Mar_19_16_15_22_2018dd',
			'data/test/InitialData_Mon_Mar_19_16_15_22_2018de',
			'data/test/InitialData_Mon_Mar_19_16_15_22_2018df',
			'data/test/InitialData_Mon_Mar_19_16_15_22_2018dg',
			'data/test/InitialData_Mon_Mar_19_16_15_22_2018dh',
			'data/test/InitialData_Mon_Mar_19_16_15_22_2018di',
			'data/test/InitialData_Mon_Mar_19_16_15_22_2018dj',
			'data/test/InitialData_Mon_Mar_19_16_15_22_2018dk',
			'data/test/InitialData_Mon_Mar_19_16_15_22_2018dl',
			'data/test/InitialData_Mon_Mar_19_16_15_22_2018dm',
			'data/test/InitialData_Mon_Mar_19_16_15_22_2018dn',
			'data/test/InitialData_Mon_Mar_19_16_15_22_2018do',
			'data/test/InitialData_Mon_Mar_19_16_15_22_2018dp',
			'data/test/InitialData_Mon_Mar_19_16_15_22_2018dq',
			'data/test/InitialData_Mon_Mar_19_16_15_22_2018dr',
			'data/test/InitialData_Mon_Mar_19_16_15_22_2018ds',
			'data/test/InitialData_Mon_Mar_19_16_15_22_2018dt',
			'data/test/InitialData_Mon_Mar_19_16_15_22_2018du',
			'data/test/InitialData_Mon_Mar_19_16_15_22_2018dv',
		],
	},
	"to":"array_sent_json",
	"appendfname":".sent.arr.json",
}

TO_CONCAT_IN = []
CONCAT_OUT_FNAME = "data/CombinedData_to_Mon_Mar_19_16_15_22_2018at.sent.arr.json"

for fname in TO_CONVERT["from"]["files"]:
	out_name = fname+TO_CONVERT["appendfname"]
	TO_CONCAT_IN.append(out_name)
	if not os.path.exists(out_name):
		print "Converting {intype} {inf} to {outtype} {out}...".format(
			intype=TO_CONVERT["from"]["type"],
			inf=fname,
			outtype=TO_CONVERT["to"],
			out=out_name,
		)
		ConvertData(
			out_filename=out_name,
			out_type=TO_CONVERT["to"],
			in_filename=fname,
			in_type=TO_CONVERT["from"]["type"],
		)

concat_arr_data_files(CONCAT_OUT_FNAME, TO_CONCAT_IN)
